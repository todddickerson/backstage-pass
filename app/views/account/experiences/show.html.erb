<%= render 'account/shared/page' do |page| %>
  <% page.title t('.section') %>
  <% page.body do %>
    <%= cable_ready_updates_for @experience do %>
      <%= render 'account/shared/box', divider: true do |box| %>
        <% box.title t('.header') %>
        <% box.description do %>
          <%= t('.description') %>
          <%= t('.manage_description') if can? :manage, @experience %>
        <% end %>

        <% box.body do %>
          <% with_attribute_settings object: @experience, strategy: :label do %>
            <%= render 'shared/attributes/text', attribute: :name %>

            <!-- Experience Type with Badge -->
            <% if @experience.experience_type.present? %>
              <div class="attribute">
                <label class="attribute-label"><%= t('experiences.fields.experience_type.heading', default: 'Type') %></label>
                <div class="mt-1">
                  <span class="inline-flex items-center px-3 py-1 rounded-md text-sm font-medium <%= experience_type_badge_class(@experience.experience_type) %>">
                    <%= @experience.experience_type.titleize %>
                  </span>
                </div>
              </div>
            <% end %>

            <%= render 'shared/attributes/html', attribute: :description %>

            <div class="attribute">
              <label class="attribute-label"><%= t('experiences.fields.price.heading', default: 'Price') %></label>
              <div class="text-2xl font-bold text-blue-600">
                <%= @experience.price_display %>
              </div>
            </div>
            <%# üöÖ super scaffolding will insert new fields above this line. %>
          <% end %>
        <% end %>

        <% box.actions do %>
          <!-- Quick Action: Jump to Latest Stream -->
          <% if @experience.streams.live.any? %>
            <%= link_to account_stream_viewing_path(@experience.streams.live.first),
                class: "inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 shadow-sm" do %>
              <svg class="w-4 h-4 mr-2 animate-pulse" fill="currentColor" viewBox="0 0 20 20">
                <circle cx="10" cy="10" r="8"/>
              </svg>
              üî¥ Watch Live Now
            <% end %>
          <% elsif @experience.streams.scheduled.any? %>
            <%= link_to [:account, @experience.streams.scheduled.first],
                class: "inline-flex items-center px-4 py-2 border border-yellow-300 text-sm font-medium rounded-md text-yellow-700 bg-yellow-50 hover:bg-yellow-100" do %>
              ‚è∫ Next Stream: <%= @experience.streams.scheduled.first.title %>
            <% end %>
          <% end %>

          <%= link_to t('.buttons.edit'), [:edit, :account, @experience], class: first_button_primary if can? :edit, @experience %>
          <%# üöÖ super scaffolding will insert new action model buttons above this line. %>
          <%= button_to t('.buttons.destroy'), [:account, @experience], method: :delete, class: first_button_primary, data: { turbo_confirm: t('.buttons.confirmations.destroy', model_locales(@experience)) } if can? :destroy, @experience %>
          <%= link_to t('global.buttons.back'), [:account, @space, :experiences], class: first_button_primary %>
        <% end %>

        <% box.raw_footer do %>
          <%# üöÖ super scaffolding will insert new action model index views above this line. %>
        <% end %>
      <% end %>
    <% end %>

    <%= render 'account/streams/index', streams: @experience.streams, hide_back: true %>
    <%# üöÖ super scaffolding will insert new children above this line. %>
  <% end %>
<% end %>
