<% content_for :page_title, "Creator Profile" %>

<div class="max-w-4xl mx-auto">
  <!-- Profile Header -->
  <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6">
    <div class="flex items-start justify-between mb-6">
      <div class="flex items-start space-x-4">
        <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center">
          <%= icon "ti ti-user-star", class: "w-8 h-8 text-blue-600" %>
        </div>
        
        <div>
          <h1 class="text-2xl font-bold text-gray-900 mb-1">
            <%= @creator_profile.display_name %>
          </h1>
          <p class="text-lg text-gray-600 mb-2">
            @<%= @creator_profile.username %>
          </p>
          
          <div class="flex items-center space-x-4 text-sm text-gray-500">
            <span>
              <%= icon "ti ti-mail", class: "w-4 h-4 inline mr-1" %>
              <%= @creator_profile.email %>
            </span>
            
            <% if @creator_profile.website_url.present? %>
              <span>
                <%= icon "ti ti-world", class: "w-4 h-4 inline mr-1" %>
                <%= link_to @creator_profile.website_url, @creator_profile.website_url, 
                           target: "_blank", class: "text-blue-600 hover:text-blue-800 underline" %>
              </span>
            <% end %>
          </div>
        </div>
      </div>
      
      <div class="flex space-x-3">
        <%= link_to "Edit Profile", edit_account_creator_profile_path, 
                   class: "bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-700 transition-colors" %>
        
        <%= link_to "View Public Profile", creator_profile_path(@creator_profile.username), 
                   target: "_blank", 
                   class: "bg-gray-200 text-gray-800 px-4 py-2 rounded-lg font-semibold hover:bg-gray-300 transition-colors" %>
      </div>
    </div>
    
    <% if @creator_profile.bio.present? %>
      <div class="prose prose-sm max-w-none text-gray-700">
        <%= @creator_profile.bio %>
      </div>
    <% end %>
  </div>

  <!-- Profile URLs -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
    <div class="bg-green-50 border border-green-200 rounded-lg p-4">
      <h3 class="font-semibold text-green-800 mb-2">Public Profile URL</h3>
      <div class="flex items-center space-x-2">
        <code class="text-sm text-green-700 bg-green-100 px-2 py-1 rounded">
          backstagepass.app/@<%= @creator_profile.username %>
        </code>
        <button onclick="copyToClipboard('<%= request.base_url %>/@<%= @creator_profile.username %>')" 
                class="text-green-600 hover:text-green-800">
          <%= icon "ti ti-copy", class: "w-4 h-4" %>
        </button>
      </div>
    </div>
    
    <% if @creator_profile.primary_space&.published? %>
      <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
        <h3 class="font-semibold text-blue-800 mb-2">Space URL</h3>
        <div class="flex items-center space-x-2">
          <code class="text-sm text-blue-700 bg-blue-100 px-2 py-1 rounded">
            backstagepass.app/spaces/<%= @creator_profile.primary_space.slug %>
          </code>
          <button onclick="copyToClipboard('<%= request.base_url %>/spaces/<%= @creator_profile.primary_space.slug %>')" 
                  class="text-blue-600 hover:text-blue-800">
            <%= icon "ti ti-copy", class: "w-4 h-4" %>
          </button>
        </div>
      </div>
    <% end %>
  </div>

  <!-- Setup Status -->
  <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
    <h2 class="text-xl font-semibold text-gray-900 mb-4">Creator Setup Status</h2>
    
    <div class="space-y-4">
      <!-- Profile Setup -->
      <div class="flex items-center space-x-3">
        <%= icon(@creator_profile.username.present? ? "ti ti-check" : "ti ti-x", 
                class: "w-5 h-5 #{@creator_profile.username.present? ? 'text-green-600' : 'text-red-500'}") %>
        <span class="text-gray-700">Creator profile setup</span>
        <% unless @creator_profile.username.present? %>
          <%= link_to "Complete →", edit_account_creator_profile_path, class: "text-blue-600 hover:text-blue-800 text-sm font-medium" %>
        <% end %>
      </div>
      
      <!-- Space Setup -->
      <div class="flex items-center space-x-3">
        <%= icon(@creator_profile.primary_space.present? ? "ti ti-check" : "ti ti-x", 
                class: "w-5 h-5 #{@creator_profile.primary_space.present? ? 'text-green-600' : 'text-red-500'}") %>
        <span class="text-gray-700">Creator space created</span>
        <% if @creator_profile.primary_space.present? %>
          <%= link_to "Manage →", account_team_space_path(current_team, @creator_profile.primary_space), 
                     class: "text-blue-600 hover:text-blue-800 text-sm font-medium" %>
        <% end %>
      </div>
      
      <!-- Space Published -->
      <div class="flex items-center space-x-3">
        <%= icon(@creator_profile.primary_space&.published? ? "ti ti-check" : "ti ti-x", 
                class: "w-5 h-5 #{@creator_profile.primary_space&.published? ? 'text-green-600' : 'text-red-500'}") %>
        <span class="text-gray-700">Space published and live</span>
        <% if @creator_profile.primary_space.present? && !@creator_profile.primary_space.published? %>
          <%= link_to "Publish →", account_team_space_path(current_team, @creator_profile.primary_space), 
                     class: "text-blue-600 hover:text-blue-800 text-sm font-medium" %>
        <% end %>
      </div>
    </div>
    
    <% unless @creator_profile.setup_complete? %>
      <div class="mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
        <div class="flex items-start space-x-3">
          <%= icon "ti ti-info-circle", class: "w-5 h-5 text-yellow-600 mt-0.5" %>
          <div>
            <h3 class="font-medium text-yellow-800 mb-1">Complete Your Setup</h3>
            <p class="text-yellow-700 text-sm">
              Finish setting up your creator profile and space to start building your audience 
              and selling access passes to your exclusive content.
            </p>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>

<script>
function copyToClipboard(text) {
  navigator.clipboard.writeText(text).then(function() {
    // Could add a toast notification here
    console.log('Copied to clipboard:', text);
  }, function(err) {
    console.error('Could not copy text: ', err);
  });
}
</script>